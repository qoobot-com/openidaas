import{v as q,ax as A,ay as T,k as L,ac as s,y as k,D as O,E as e,F as o,z as j,R as z,S as d,G as D,U as G,r as w,l as K}from"./vue-vendor-BojGzKWy.js";import{u as $}from"./user-DoM5hWmZ.js";import{E as b}from"./element-plus-CD8Xv7xU.js";import{_ as H}from"./index-MeEtieb6.js";import"./axios-C0Zqfgkc.js";const J={class:"user-form-container"},P={class:"card-header"},Q=q({__name:"UserForm",setup(W){const U=A(),C=T(),g=$(),p=w(),i=w(!1),V=w(0),a=K({username:"",email:"",mobile:"",status:"ACTIVE",password:"",profile:{fullName:"",nickname:"",gender:0,birthDate:"",employeeId:""}}),I={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度为3-20个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],mobile:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}]},E=async()=>{try{const r=await g.getUserById(V.value);r&&(a.username=r.username,a.email=r.email||"",a.mobile=r.mobile||"",a.status=r.status,r.profile&&Object.assign(a.profile,r.profile))}catch(r){console.error("获取用户详情失败:",r),b.error("获取用户详情失败")}},N=async()=>{p.value&&await p.value.validate(async r=>{if(r)try{if(i.value){const l={email:a.email,mobile:a.mobile,profile:a.profile,status:a.status};await g.updateUser(V.value,l),b.success("用户更新成功")}else{const l={username:a.username,email:a.email,password:a.password,profile:a.profile};await g.createUser(l),b.success("用户创建成功")}c()}catch(l){console.error("保存用户失败:",l),b.error("保存用户失败")}})},x=()=>{var r;(r=p.value)==null||r.resetFields()},c=()=>{C.go(-1)};return L(()=>{U.params.id&&(i.value=!0,V.value=Number(U.params.id),E())}),(r,l)=>{const f=s("el-button"),m=s("el-input"),u=s("el-form-item"),n=s("el-col"),_=s("el-row"),v=s("el-option"),Y=s("el-select"),B=s("el-divider"),y=s("el-radio"),F=s("el-radio-group"),M=s("el-date-picker"),R=s("el-form"),S=s("el-card");return k(),O("div",J,[e(S,null,{header:o(()=>[D("div",P,[D("span",null,G(i.value?"编辑用户":"新增用户"),1),e(f,{onClick:c},{default:o(()=>[...l[10]||(l[10]=[d("返回",-1)])]),_:1})])]),default:o(()=>[e(R,{ref_key:"formRef",ref:p,model:a,rules:I,"label-width":"100px"},{default:o(()=>[e(_,{gutter:20},{default:o(()=>[e(n,{span:12},{default:o(()=>[e(u,{label:"用户名",prop:"username"},{default:o(()=>[e(m,{modelValue:a.username,"onUpdate:modelValue":l[0]||(l[0]=t=>a.username=t),disabled:i.value},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(u,{label:"邮箱",prop:"email"},{default:o(()=>[e(m,{modelValue:a.email,"onUpdate:modelValue":l[1]||(l[1]=t=>a.email=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,{gutter:20},{default:o(()=>[e(n,{span:12},{default:o(()=>[e(u,{label:"手机号",prop:"mobile"},{default:o(()=>[e(m,{modelValue:a.mobile,"onUpdate:modelValue":l[2]||(l[2]=t=>a.mobile=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(u,{label:"状态",prop:"status"},{default:o(()=>[e(Y,{modelValue:a.status,"onUpdate:modelValue":l[3]||(l[3]=t=>a.status=t),style:{width:"100%"}},{default:o(()=>[e(v,{label:"正常",value:"ACTIVE"}),e(v,{label:"锁定",value:"LOCKED"}),e(v,{label:"禁用",value:"DISABLED"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),i.value?z("",!0):(k(),j(u,{key:0,label:"密码",prop:"password"},{default:o(()=>[e(m,{modelValue:a.password,"onUpdate:modelValue":l[4]||(l[4]=t=>a.password=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1})),e(B,null,{default:o(()=>[...l[11]||(l[11]=[d("个人信息",-1)])]),_:1}),e(_,{gutter:20},{default:o(()=>[e(n,{span:12},{default:o(()=>[e(u,{label:"姓名",prop:"profile.fullName"},{default:o(()=>[e(m,{modelValue:a.profile.fullName,"onUpdate:modelValue":l[5]||(l[5]=t=>a.profile.fullName=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(u,{label:"昵称",prop:"profile.nickname"},{default:o(()=>[e(m,{modelValue:a.profile.nickname,"onUpdate:modelValue":l[6]||(l[6]=t=>a.profile.nickname=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,{gutter:20},{default:o(()=>[e(n,{span:12},{default:o(()=>[e(u,{label:"性别",prop:"profile.gender"},{default:o(()=>[e(F,{modelValue:a.profile.gender,"onUpdate:modelValue":l[7]||(l[7]=t=>a.profile.gender=t)},{default:o(()=>[e(y,{label:1},{default:o(()=>[...l[12]||(l[12]=[d("男",-1)])]),_:1}),e(y,{label:2},{default:o(()=>[...l[13]||(l[13]=[d("女",-1)])]),_:1}),e(y,{label:0},{default:o(()=>[...l[14]||(l[14]=[d("保密",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(u,{label:"生日",prop:"profile.birthDate"},{default:o(()=>[e(M,{modelValue:a.profile.birthDate,"onUpdate:modelValue":l[8]||(l[8]=t=>a.profile.birthDate=t),type:"date",placeholder:"选择日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(u,{label:"员工编号",prop:"profile.employeeId"},{default:o(()=>[e(m,{modelValue:a.profile.employeeId,"onUpdate:modelValue":l[9]||(l[9]=t=>a.profile.employeeId=t)},null,8,["modelValue"])]),_:1}),e(u,null,{default:o(()=>[e(f,{type:"primary",onClick:N},{default:o(()=>[...l[15]||(l[15]=[d("保存",-1)])]),_:1}),e(f,{onClick:x},{default:o(()=>[...l[16]||(l[16]=[d("重置",-1)])]),_:1}),e(f,{onClick:c},{default:o(()=>[...l[17]||(l[17]=[d("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}}),oe=H(Q,[["__scopeId","data-v-6433485a"]]);export{oe as default};
